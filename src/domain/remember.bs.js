// Generated by ReScript, PLEASE EDIT WITH CARE

import * as View from "./view.bs.js";
import * as Stack from "./stack.bs.js";

var empty = {
  stack: Stack.empty,
  view: View.empty,
  iteration: 0
};

function addCard(t, card) {
  return {
          stack: Stack.Update.addCard(t.stack, card),
          view: t.view,
          iteration: t.iteration
        };
}

function startReview(t) {
  var cards = Stack.Selectors.getCards(t.stack, t.iteration);
  return {
          stack: t.stack,
          view: cards ? View.make(cards.hd, cards.tl) : View.empty,
          iteration: t.iteration
        };
}

function next(t, known) {
  var review = t.view;
  if (!review) {
    return t;
  }
  var newReview = View.Update.next(review._0, known);
  var match = newReview.reviewing;
  if (match !== undefined) {
    return {
            stack: t.stack,
            view: /* Review */{
              _0: newReview
            },
            iteration: t.iteration
          };
  } else {
    return {
            stack: Stack.Update.updateCards(Stack.Update.updateCards(t.stack, newReview.remember), newReview.forget),
            view: /* Overview */0,
            iteration: t.iteration + 1 | 0
          };
  }
}

var Update = {
  addCard: addCard,
  startReview: startReview,
  next: next
};

export {
  empty ,
  Update ,
  
}
/* No side effect */
