// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Card from "./card.bs.js";
import * as Curry from "rescript/lib/es6/curry.js";
import * as Stack from "./stack.bs.js";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";

var emptyReview = {
  toReview: Stack.empty,
  reviewing: undefined,
  remember: Stack.empty,
  forget: Stack.empty
};

function make(head, tail) {
  return /* Review */{
          _0: {
            toReview: tail,
            reviewing: head,
            remember: Stack.empty,
            forget: Stack.empty
          }
        };
}

function andThen(f, g, x) {
  return Curry._1(g, Curry._1(f, x));
}

function next(param, known) {
  var forget = param.forget;
  var remember = param.remember;
  var reviewing = param.reviewing;
  var toReview = param.toReview;
  var remember$1 = Belt_Option.getWithDefault(Belt_Option.map(known ? reviewing : undefined, (function (param) {
              var param$1 = Card.Update.next(param);
              return Stack.Update.addCard(remember, param$1);
            })), remember);
  var forget$1 = Belt_Option.getWithDefault(Belt_Option.map(!known ? reviewing : undefined, (function (param) {
              var param$1 = Card.Update.back(param);
              return Stack.Update.addCard(forget, param$1);
            })), forget);
  var match = toReview ? [
      toReview.hd,
      toReview.tl
    ] : [
      undefined,
      /* [] */0
    ];
  return {
          toReview: match[1],
          reviewing: match[0],
          remember: remember$1,
          forget: forget$1
        };
}

var Update = {
  next: next
};

var empty = /* Overview */0;

export {
  emptyReview ,
  empty ,
  make ,
  andThen ,
  Update ,
  
}
/* No side effect */
